title = "5dlabs/cto-parallel-test gitleaks config"

[extend]
# Use the maintained default gitleaks ruleset
useDefault = true

[allowlist]
description = "Allow common test paths"
# Keep allowlist minimal; expand only if tests trip rules
paths = [
  '''(^|/)test[s]?/''',
  '''(^|/)tests?/data/''',
  # Documentation and task specs can include illustrative secrets
  '''^docs/''',
  '''^task/''',
  # Ignore build artifacts
  '''^target/''',
]

# Minimize false positives from clearly test-only literals used in unit tests
# These regexes are narrowly scoped to non-production examples
regexes = [
  # Example JWT used in tests
  '''token:\s*"sample\.jwt\.token"''',
  # Example JSON payloads in tests and docs
  '''\"password\"\s*:\s*\"test(pass|pw|password)?\"''',
  # Example variable assignments in tests
  '''let\s+(special_)?password(_with_spaces)?\s*=\s*\"[ a-zA-Z0-9@!#\$%\^&\*\(\)\{\}\[\]<>\?\\/\|\.-]+\"''',
]

# Allowlist historical commits that contain only test/demo secrets
# This avoids failing scans on known-safe examples committed during scaffolding
commits = [
  "0f117d69e3afab8adc88106b5b64eb1f7507686f",
  "220fdb89af78bad4299f9162e30dca733b9c37c8",
  "338826ef548c914e7e9b64d50db75a00174ec933",
  "553ca8dc373cdc2255f830d08fe33bed1224b1ff",
  "57284d609f212fe686f3a7e257a7250daa9f0821",
  "7d139b2089e03533e86a90c5cab2c80d23f0d228",
  "8e56d8ed11f86022f943905216e03f5289c6e9ac",
  "b06f2559c2b4fb906f6603baf5005aeeb6aec64f",
  "b0e5ce60c50fa1d653740cb145338627ef27770a",
  "bf9c62351e620c07dcbd67b84064a62aad4e5ba7",
  "dcb9245f78e16999bfe04d9199b2c88d844d270a",
  # Historical commit used for auth module tests; includes only non-sensitive test literals
  "9c46261b2933fe7a239f995ea7f9b1b1ee4f589c",
  # Commit contains only non-sensitive auth scaffolding and test literals; false positive on Terraform password rule in Rust code
  "56e2f025c07193c65ce8711697428b64ca6115cf",
]
